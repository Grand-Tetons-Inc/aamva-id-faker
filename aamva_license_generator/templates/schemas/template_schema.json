{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aamva-license-generator.org/schemas/template.json",
  "title": "AAMVA License Template",
  "description": "JSON schema for AAMVA license generation templates",
  "type": "object",
  "required": ["name", "version", "description"],
  "properties": {
    "name": {
      "type": "string",
      "description": "Unique template identifier",
      "pattern": "^[a-zA-Z0-9_-]+$",
      "minLength": 1,
      "maxLength": 100,
      "examples": ["age_verification", "expired_licenses", "all_states"]
    },
    "version": {
      "type": "string",
      "description": "Template version in semver format",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.]+)?(\\+[a-zA-Z0-9.]+)?$",
      "examples": ["1.0.0", "2.1.3", "1.0.0-beta.1"]
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of template purpose",
      "minLength": 10,
      "maxLength": 500
    },
    "author": {
      "type": "string",
      "description": "Template author or organization",
      "default": "AAMVA Team",
      "examples": ["AAMVA Team", "Security Trainer", "QA Engineer"]
    },
    "tags": {
      "type": "array",
      "description": "Tags for categorization and search",
      "items": {
        "type": "string",
        "pattern": "^[a-z_]+$"
      },
      "uniqueItems": true,
      "examples": [["testing", "age_verification"], ["training", "demo"]]
    },
    "parameters": {
      "type": "object",
      "description": "Template parameter values",
      "properties": {
        "state": {
          "type": "string",
          "description": "US state code",
          "pattern": "^[A-Z]{2}$|^ALL$",
          "examples": ["CA", "NY", "TX", "ALL"]
        },
        "count": {
          "type": "integer",
          "description": "Number of licenses to generate",
          "minimum": 1,
          "maximum": 10000,
          "examples": [10, 50, 100]
        },
        "output_dir": {
          "type": "string",
          "description": "Output directory path",
          "examples": ["output", "output/testing", "/tmp/licenses"]
        },
        "age_min": {
          "type": "integer",
          "description": "Minimum age in years",
          "minimum": 16,
          "maximum": 120
        },
        "age_max": {
          "type": "integer",
          "description": "Maximum age in years",
          "minimum": 16,
          "maximum": 120
        },
        "is_expired": {
          "type": "boolean",
          "description": "Generate expired licenses"
        },
        "is_veteran": {
          "type": "boolean",
          "description": "Mark as veteran"
        },
        "is_organ_donor": {
          "type": "boolean",
          "description": "Mark as organ donor"
        },
        "expiration_days_from_now": {
          "type": "integer",
          "description": "Days until expiration (negative for expired)",
          "minimum": -3650,
          "maximum": 3650
        },
        "include_photo": {
          "type": "boolean",
          "description": "Include photo placeholder"
        },
        "format": {
          "type": "string",
          "description": "Output format",
          "enum": ["pdf", "docx", "odt", "png", "json"],
          "examples": ["pdf", "json"]
        }
      },
      "additionalProperties": true
    },
    "parameter_definitions": {
      "type": "array",
      "description": "Definitions for each parameter",
      "items": {
        "$ref": "#/definitions/parameter_definition"
      }
    },
    "parent_template": {
      "type": ["string", "null"],
      "description": "Name of parent template for inheritance",
      "pattern": "^[a-zA-Z0-9_-]+$",
      "examples": ["base_template", "age_verification"]
    },
    "variables": {
      "type": "object",
      "description": "Runtime variables for substitution",
      "patternProperties": {
        "^[A-Z][A-Z0-9_]*$": {
          "description": "Variable value (any type)"
        }
      },
      "examples": [{"STATE": "CA", "COUNT": "10"}]
    },
    "metadata": {
      "type": "object",
      "description": "Template metadata",
      "properties": {
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "Creation timestamp"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time",
          "description": "Last update timestamp"
        },
        "cloned_from": {
          "type": "string",
          "description": "Original template if cloned"
        },
        "imported_from": {
          "type": "string",
          "description": "Import source path"
        }
      },
      "additionalProperties": true
    },
    "documentation": {
      "type": "string",
      "description": "Extended documentation in Markdown format",
      "examples": ["# Template Documentation\n\nThis template generates..."]
    }
  },
  "definitions": {
    "parameter_definition": {
      "type": "object",
      "required": ["name", "type"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Parameter name",
          "pattern": "^[a-z_][a-z0-9_]*$"
        },
        "type": {
          "type": "string",
          "description": "Parameter data type",
          "enum": ["string", "integer", "float", "boolean", "date", "enum", "list", "dict"]
        },
        "default": {
          "description": "Default value (any type)"
        },
        "description": {
          "type": "string",
          "description": "Parameter description"
        },
        "required": {
          "type": "boolean",
          "description": "Whether parameter is required",
          "default": false
        },
        "validation": {
          "type": "object",
          "description": "Validation rules",
          "properties": {
            "min_value": {
              "type": "number",
              "description": "Minimum value for numeric types"
            },
            "max_value": {
              "type": "number",
              "description": "Maximum value for numeric types"
            },
            "min_length": {
              "type": "integer",
              "description": "Minimum length for strings/lists"
            },
            "max_length": {
              "type": "integer",
              "description": "Maximum length for strings/lists"
            },
            "pattern": {
              "type": "string",
              "description": "Regular expression pattern for validation"
            },
            "enum_values": {
              "type": "array",
              "description": "List of allowed values for enum type"
            }
          },
          "additionalProperties": false
        },
        "examples": {
          "type": "array",
          "description": "Example values",
          "items": {}
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
